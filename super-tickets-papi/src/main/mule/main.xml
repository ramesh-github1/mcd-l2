<?xml version="1.0" encoding="UTF-8"?>

<mule
	xmlns:super-heros-bio-data-sapi="http://www.mulesoft.org/schema/mule/super-heros-bio-data-sapi"
	xmlns:super-heros-movies-data-sapi="http://www.mulesoft.org/schema/mule/super-heros-movies-data-sapi"
	xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/super-heros-movies-data-sapi http://www.mulesoft.org/schema/mule/super-heros-movies-data-sapi/current/mule-super-heros-movies-data-sapi.xsd
http://www.mulesoft.org/schema/mule/super-heros-bio-data-sapi http://www.mulesoft.org/schema/mule/super-heros-bio-data-sapi/current/mule-super-heros-bio-data-sapi.xsd">
	<flow
		name="get-tickets-data-by-bid"
		doc:id="1a0d3b06-3c16-4886-9133-193cfe3f6b25">
		<logger
			level="INFO"
			doc:name="Log Corelation ID"
			doc:id="f4621f1c-3e52-49e6-ad69-e45dc9f57838"
			message="#['\n---------------------------------------------------------------------\n' &#10;++ 'flow started with correlationID - ' ++ correlationId ++ &#10;'\n----------------------------------------------------------------------\n']" />
		<super-heros-movies-data-sapi:fetch-movies-data-using-cid
			doc:name="Fetch Movies Data using CID"
			doc:id="408882a7-2bd9-48ce-bd1c-939c4fdb716d"
			config-ref="superHerosMoviesDataSAPIConfig"
			id="#[vars.CID default 50]"
			target="super-movies" />
		<super-heros-bio-data-sapi:get-biodata-by-cid
			doc:name="Get BioData by CID"
			doc:id="b01d214a-e54c-45d9-ab85-78be5246db37"
			config-ref="superHerosBioDataSAPIConfig"
			id='#[vars.CID default "MARVEL0001"]'
			target="super-biodata" />
		<ee:transform doc:name="Transform Message">
			<ee:message>
				<ee:set-payload><![CDATA[%dw 2.0
output application/json
---
{
  ticket: {
    booking_id: "BID7890",
    film_name: "Avengers - Infinity War.",
    cinema_name: "Acme IMAX",
    screen_name: "Audi 7",
    seats: "RR - H4",
    imdb_rating: 8.9,
    language: "English",
    date_time: "Tue, 08 Feb, 2022 | 04:26 PM"
  },
  character: {
    id: "MARVEL0002",
    name: "Thanos",
    birthplace: "Titan",
    publisher: "Marvel Comics",
    movies: [
      {
        name: "Avengers Endgame,",
        year: 2019
      }, 
      {
        name: "Guardians of the Galaxy",
        year: 2014
      }
    ]
  }
} as Object {encoding: "UTF-8", mediaType: "application/json"}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
	</flow>
</mule>
